<!DOCTYPE html><html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title>Ticket Watcher (GitHub Pages)</title>
  <style>
    body {
      font-family: sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      direction: rtl;
    }
    .card {
      background: white;
      padding: 30px;
      border-radius: 14px;
      width: 360px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    }
    h1 {
      margin-bottom: 15px;
      font-size: 20px;
      text-align: center;
    }
    input, button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 14px;
    }
    button {
      background: #667eea;
      border: none;
      color: white;
      border-radius: 8px;
      cursor: pointer;
    }
    #status {
      margin-top: 12px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>بررسی موجودی بلیط</h1>
    <input id="url" placeholder="لینک خرید بلیط را وارد کنید" />
    <input id="text" placeholder="متن مورد نظر را وارد کنید" />
    <button onclick="startSearch()">شروع جستجو</button>
    <p id="status"></p>
  </div>  <script>
    let interval;

    async function checkPage(url, text) {
      try {
        const res = await fetch(url);
        const html = await res.text();
        return html.includes(text);
      } catch (e) {
        return 'cors-error';
      }
    }

    function startSearch() {
      const url = document.getElementById('url').value;
      const text = document.getElementById('text').value;
      const status = document.getElementById('status');

      if (interval) clearInterval(interval);

      interval = setInterval(async () => {
        status.innerText = 'در حال جستجو...';
        const result = await checkPage(url, text);

        if (result === true) {
          status.innerText = 'بلیط پیدا شد ✅';
          alert('بلیط پیدا شد!');
          clearInterval(interval);
        } else if (result === false) {
          status.innerText = 'هنوز پیدا نشد...';
        } else {
          status.innerText = '❌ سایت مقصد اجازه دسترسی نمی‌دهد (CORS)';
          clearInterval(interval);
        }
      }, 3000);
    }
  </script></body>
</html>
